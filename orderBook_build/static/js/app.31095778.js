(function(){"use strict";var t={8344:function(t,s,e){var i=e(6369),o=function(){var t=this,s=t._self._c;return s("div",{attrs:{id:"app"}},[s("OrderBook")],1)},r=[],a=function(){var t=this,s=t._self._c;return s("div",{attrs:{id:"OrderBook"}},[s("section",{staticClass:"orderBook_Section"},[s("h2",[t._v("Order Book")]),s("div",{staticClass:"listContainer"},[t._m(0),s("div",{staticClass:"block sellBlock"},[s("TransitionGroup",{attrs:{name:"highlightSell",mode:"out-in"}},t._l(t.top8_Asks,(function([e,[i,o]],r){return s("ul",{key:e,staticClass:"list"},[s("li",{staticClass:"sellText priceText"},[t._v(" "+t._s(t.commaFormat(e))+" ")]),s("li",{staticClass:"sizeText",class:{sell_AnimateClass:t.asks_Size_Animation_Active[r][0],buy_AnimateClass:t.asks_Size_Animation_Active[r][1]}},[t._v(" "+t._s(t.commaFormat(i))+" ")]),s("li",{staticClass:"totalText"},[t._v(" "+t._s(t.commaFormat(o))+" "),s("div",{staticClass:"bar",style:{width:t.get_Percentage(o,t.get_top8_MaxTotalSize(t.top8_Asks))}})])])})),0)],1),s("div",{staticClass:"block buyBlock"},[s("TransitionGroup",{attrs:{name:"highlightBuy",mode:"out-in"}},t._l(t.top8_Bids,(function([e,[i,o]],r){return s("ul",{key:e,staticClass:"list"},[s("li",{staticClass:"buyText priceText"},[t._v(" "+t._s(t.commaFormat(e))+" ")]),s("li",{staticClass:"sizeText",class:{sell_AnimateClass:t.bids_Size_Animation_Active[r][0],buy_AnimateClass:t.bids_Size_Animation_Active[r][1]}},[t._v(" "+t._s(t.commaFormat(i))+" ")]),s("li",{staticClass:"totalText"},[t._v(" "+t._s(t.commaFormat(o))+" "),s("div",{staticClass:"bar",style:{width:t.get_Percentage(o,t.get_top8_MaxTotalSize(t.top8_Bids))}})])])})),0)],1)])]),s("button",{on:{click:t.startWebSocket1}},[t._v("startWebSocket1")]),s("button",{on:{click:function(s){return t.subscribe(t.ws1,t.subscriptionOrderBook)}}},[t._v("subscribe 1")]),s("button",{on:{click:function(s){return t.stop(t.ws1,t.unsubscriptionOrderBook)}}},[t._v("stop 1")]),s("div",[s("transition",{attrs:{name:"highlight",mode:"out-in"}},[s("div",{key:t.targetValue},[t._v(t._s(t.targetValue))])]),s("button",{on:{click:function(s){t.targetValue+=1}}},[t._v("Update Value")])],1)])},n=[function(){var t=this,s=t._self._c;return s("ul",{staticClass:"titleList"},[s("li",{staticClass:"listTitleText priceText"},[t._v("Price (USD)")]),s("li",{staticClass:"listTitleText sizeText"},[t._v("Size")]),s("li",{staticClass:"listTitleText totalText"},[t._v("Total")])])}],c={name:"OrderBook",data(){return{ws1:new WebSocket("wss://ws.btse.com/ws/oss/futures"),ws2:new WebSocket("wss://ws.btse.com/ws/futures"),targetValue:0,orderBookMap:{asks:new Map,bids:new Map},top8_Asks:Array(8).fill().map(((t,s)=>[s,[0,0]])),top8_Bids:Array(8).fill().map(((t,s)=>[s,[0,0]])),subscriptionOrderBook:{op:"subscribe",args:["update:BTC-PERP"]},unsubscriptionOrderBook:{op:"unsubscribe",args:["update:BTC-PERP"]},subscriptionPriceUpdate:{op:"subscribe",args:["tradeHistoryApi:BTCPFC"]},unsubscriptionPriceUpdate:{op:"unsubscribe",args:["tradeHistoryApi:BTCPFC"]},asks_Size_Animation_Active:Array(8).fill().map((()=>[!1,!1])),bids_Size_Animation_Active:Array(8).fill().map((()=>[!1,!1]))}},computed:{},methods:{commaFormat(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},get_Percentage(t,s){return 100*(t/s).toFixed(2)+"%"},get_top8_MaxTotalSize(t){let s=0;for(let e=0;e<t.length;e++)s=Math.max(s,t[e][1][1]);return s},update_Top8(){const t=[...this.orderBookMap["asks"]].sort(((t,s)=>s[0]-t[0])).slice(0,8),s=[...this.orderBookMap["bids"]].sort(((t,s)=>s[0]-t[0])).slice(0,8);for(let e=0;e<8;e++)this.top8_Asks[e]=t[e],this.top8_Bids[e]=s[e];this.$forceUpdate()},update_Delta_Price(t,s){for(let[e,i]of s)if(e*=1,i*=1,0!==i){this.orderBookMap[t].has(e)||this.orderBookMap[t].set(e,[0,0]);const s=this.orderBookMap[t].get(e)[1];for(let o=0;o<8;o++){if("asks"===t&&this.top8_Asks[o][0]===e){this.update_Size(o,e,i,s,"asks");break}if("bids"===t&&this.top8_Bids[o][0]===e){this.update_Size(o,e,i,s,"bids");break}}this.orderBookMap[t].get(e)[0]=i,this.orderBookMap[t].get(e)[1]=s+i}else this.orderBookMap[t].delete(e)},update_Size(t,s,e,i,o){if("asks"===o){const o=this.top8_Asks[t][1][0];this.$set(this.top8_Asks,t,[s,[e,i+e]]),e<o?this.asks_Size_Animation_Active[t][0]=!0:e>o&&(this.asks_Size_Animation_Active[t][1]=!0),setTimeout((()=>{this.asks_Size_Animation_Active[t]=[!1,!1]}),700)}else if("bids"===o){const o=this.top8_Bids[t][1][0];this.$set(this.top8_Bids,t,[s,[e,i+e]]),e<o?this.bids_Size_Animation_Active[t][0]=!0:e>o&&(this.bids_Size_Animation_Active[t][1]=!0),setTimeout((()=>{this.bids_Size_Animation_Active[t]=[!1,!1]}),700)}},startWebSocket1(){console.log(this.ws1),this.ws1.onopen=()=>{},this.ws1.onmessage=t=>{const s=JSON.parse(t.data).data;if(void 0!==s)if("snapshot"===s.type){this.orderBookMap.asks.clear(),this.orderBookMap.bids.clear();const[t,e]=[s.asks,s.bids];for(let s=0;s<50;s++){const[i,o]=[1*t[s][0],1*t[s][1]],[r,a]=[1*e[s][0],1*e[s][1]];this.orderBookMap["asks"].set(i,[o,o]),this.orderBookMap["bids"].set(r,[a,a])}this.update_Top8()}else"delta"===s.type&&(this.update_Delta_Price("asks",s.asks),this.update_Delta_Price("bids",s.bids),this.update_Top8())},this.ws1.onclose=()=>{console.log("is Closed 1")}},subscribe(t,s){t&&t.send(JSON.stringify(s))},stop(t,s){t&&t.send(JSON.stringify(s))},startWebSocket2(){console.log(this.ws2),this.ws2.onopen=()=>{},this.ws2.onmessage=t=>{const s=JSON.parse(t.data).data;void 0!==s&&console.log(s)},this.ws2.onclose=()=>{console.log("is Closed 2")}}},created(){this.startWebSocket1(),this.startWebSocket2()},watch:{}},l=c,u=e(1001),d=(0,u.Z)(l,a,n,!1,null,null,null),p=d.exports,_={name:"App",components:{OrderBook:p},data(){return{}},methods:{},created(){}},h=_,b=(0,u.Z)(h,o,r,!1,null,null,null),f=b.exports,k=e(7139);i.ZP.use(k.ZP);var m=new k.ZP.Store({state:{},mutations:{},actions:{},getters:{}});i.ZP.config.productionTip=!1,new i.ZP({store:m,render:t=>t(f)}).$mount("#app")}},s={};function e(i){var o=s[i];if(void 0!==o)return o.exports;var r=s[i]={exports:{}};return t[i].call(r.exports,r,r.exports,e),r.exports}e.m=t,function(){var t=[];e.O=function(s,i,o,r){if(!i){var a=1/0;for(u=0;u<t.length;u++){i=t[u][0],o=t[u][1],r=t[u][2];for(var n=!0,c=0;c<i.length;c++)(!1&r||a>=r)&&Object.keys(e.O).every((function(t){return e.O[t](i[c])}))?i.splice(c--,1):(n=!1,r<a&&(a=r));if(n){t.splice(u--,1);var l=o();void 0!==l&&(s=l)}}return s}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[i,o,r]}}(),function(){e.n=function(t){var s=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(s,{a:s}),s}}(),function(){e.d=function(t,s){for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)}}(),function(){var t={143:0};e.O.j=function(s){return 0===t[s]};var s=function(s,i){var o,r,a=i[0],n=i[1],c=i[2],l=0;if(a.some((function(s){return 0!==t[s]}))){for(o in n)e.o(n,o)&&(e.m[o]=n[o]);if(c)var u=c(e)}for(s&&s(i);l<a.length;l++)r=a[l],e.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return e.O(u)},i=self["webpackChunkorderbook"]=self["webpackChunkorderbook"]||[];i.forEach(s.bind(null,0)),i.push=s.bind(null,i.push.bind(i))}();var i=e.O(void 0,[998],(function(){return e(8344)}));i=e.O(i)})();
//# sourceMappingURL=app.31095778.js.map