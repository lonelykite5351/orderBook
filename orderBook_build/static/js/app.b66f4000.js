(function(){"use strict";var t={38:function(t,s,i){var e=i(6369),o=function(){var t=this,s=t._self._c;return s("div",{attrs:{id:"app"}},[s("OrderBook")],1)},r=[],a=function(){var t=this,s=t._self._c;return s("div",{attrs:{id:"OrderBook"}},[s("section",{staticClass:"orderBook_Section"},[s("h2",[t._v("Order Book")]),s("div",{staticClass:"listContainer"},[t._m(0),s("div",{staticClass:"block sellBlock"},[s("TransitionGroup",{attrs:{name:"highlightSell",mode:"out-in"}},t._l(t.top8_Asks,(function([i,[e,o]],r){return s("ul",{key:i,staticClass:"list"},[s("li",{staticClass:"sellText priceText"},[t._v(" "+t._s(t.commaFormat(i))+" ")]),s("li",{staticClass:"sizeText",class:{sell_AnimateClass:t.asks_Size_Animation_Active[r][0],buy_AnimateClass:t.asks_Size_Animation_Active[r][1]}},[t._v(" "+t._s(t.commaFormat(e))+" ")]),s("li",{staticClass:"totalText"},[t._v(" "+t._s(t.commaFormat(o))+" "),s("div",{staticClass:"bar",style:{width:t.get_Percentage(o,t.get_top8_MaxTotalSize(t.top8_Asks))}})])])})),0)],1),s("div",{staticClass:"current_BuyPrice_Block",class:{sellColor:t.buyPrice_Animation_Active.sell,buyColor:t.buyPrice_Animation_Active.buy}},[s("div",[s("h3",[t._v(t._s(t.commaFormat(t.currentBuyPrice)))]),s("span",{directives:[{name:"show",rawName:"v-show",value:t.buyPrice_Animation_Active.sell,expression:"buyPrice_Animation_Active.sell"}],staticClass:"downArrow sellText"},[t._v("⇩")]),s("span",{directives:[{name:"show",rawName:"v-show",value:t.buyPrice_Animation_Active.buy,expression:"buyPrice_Animation_Active.buy"}],staticClass:"upArrow buyText"},[t._v("⇧")])])]),s("div",{staticClass:"block buyBlock"},[s("TransitionGroup",{attrs:{name:"highlightBuy",mode:"out-in"}},t._l(t.top8_Bids,(function([i,[e,o]],r){return s("ul",{key:i,staticClass:"list"},[s("li",{staticClass:"buyText priceText"},[t._v(" "+t._s(t.commaFormat(i))+" ")]),s("li",{staticClass:"sizeText",class:{sell_AnimateClass:t.bids_Size_Animation_Active[r][0],buy_AnimateClass:t.bids_Size_Animation_Active[r][1]}},[t._v(" "+t._s(t.commaFormat(e))+" ")]),s("li",{staticClass:"totalText"},[t._v(" "+t._s(t.commaFormat(o))+" "),s("div",{staticClass:"bar",style:{width:t.get_Percentage(o,t.get_top8_MaxTotalSize(t.top8_Bids))}})])])})),0)],1)])]),s("button",{on:{click:t.startWebSocket1}},[t._v("startWebSocket1")]),s("button",{on:{click:t.startWebSocket2}},[t._v("startWebSocket2")]),s("button",{on:{click:t.subscribeAll}},[t._v("Subscribe All")]),s("button",{on:{click:t.stopAll}},[t._v("Stop All")])])},n=[function(){var t=this,s=t._self._c;return s("ul",{staticClass:"titleList"},[s("li",{staticClass:"listTitleText priceText"},[t._v("Price (USD)")]),s("li",{staticClass:"listTitleText sizeText"},[t._v("Size")]),s("li",{staticClass:"listTitleText totalText"},[t._v("Total")])])}],c={name:"OrderBook",data(){return{ws1:new WebSocket("wss://ws.btse.com/ws/oss/futures"),ws2:new WebSocket("wss://ws.btse.com/ws/futures"),currentBuyPrice:0,orderBookMap:{asks:new Map,bids:new Map},top8_Asks:Array(8).fill().map(((t,s)=>[s,[0,0]])),top8_Bids:Array(8).fill().map(((t,s)=>[s,[0,0]])),subscriptionOrderBook:{op:"subscribe",args:["update:BTC-PERP"]},unsubscriptionOrderBook:{op:"unsubscribe",args:["update:BTC-PERP"]},subscriptionPriceUpdate:{op:"subscribe",args:["tradeHistoryApi:BTCPFC"]},unsubscriptionPriceUpdate:{op:"unsubscribe",args:["tradeHistoryApi:BTCPFC"]},asks_Size_Animation_Active:Array(8).fill().map((()=>[!1,!1])),bids_Size_Animation_Active:Array(8).fill().map((()=>[!1,!1])),buyPrice_Animation_Active:{sell:!1,buy:!0}}},computed:{},methods:{commaFormat(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},get_Percentage(t,s){return 100*(t/s).toFixed(2)+"%"},get_top8_MaxTotalSize(t){let s=0;for(let i=0;i<t.length;i++)s=Math.max(s,t[i][1][1]);return s},update_Top8(){const t=[...this.orderBookMap["asks"]].sort(((t,s)=>s[0]-t[0])).slice(0,8),s=[...this.orderBookMap["bids"]].sort(((t,s)=>s[0]-t[0])).slice(0,8);for(let i=0;i<8;i++)this.top8_Asks[i]=t[i],this.top8_Bids[i]=s[i];this.$forceUpdate()},update_Delta_Price(t,s){for(let[i,e]of s)if(i*=1,e*=1,0!==e){this.orderBookMap[t].has(i)||this.orderBookMap[t].set(i,[0,0]);const s=this.orderBookMap[t].get(i)[1];for(let o=0;o<8;o++){if("asks"===t&&this.top8_Asks[o][0]===i){this.update_Size(o,i,e,s,"asks");break}if("bids"===t&&this.top8_Bids[o][0]===i){this.update_Size(o,i,e,s,"bids");break}}this.orderBookMap[t].get(i)[0]=e,this.orderBookMap[t].get(i)[1]=s+e}else this.orderBookMap[t].delete(i)},update_Size(t,s,i,e,o){if("asks"===o){const o=this.top8_Asks[t][1][0];this.$set(this.top8_Asks,t,[s,[i,e+i]]),i<o?this.asks_Size_Animation_Active[t][0]=!0:i>o&&(this.asks_Size_Animation_Active[t][1]=!0),setTimeout((()=>{this.asks_Size_Animation_Active[t]=[!1,!1]}),700)}else if("bids"===o){const o=this.top8_Bids[t][1][0];this.$set(this.top8_Bids,t,[s,[i,e+i]]),i<o?this.bids_Size_Animation_Active[t][0]=!0:i>o&&(this.bids_Size_Animation_Active[t][1]=!0),setTimeout((()=>{this.bids_Size_Animation_Active[t]=[!1,!1]}),700)}},startWebSocket1(){console.log(this.ws1),this.ws1.onopen=()=>{},this.ws1.onmessage=t=>{const s=JSON.parse(t.data).data;if(void 0!==s)if("snapshot"===s.type){this.orderBookMap.asks.clear(),this.orderBookMap.bids.clear();const[t,i]=[s.asks,s.bids];for(let s=0;s<50;s++){const[e,o]=[1*t[s][0],1*t[s][1]],[r,a]=[1*i[s][0],1*i[s][1]];this.orderBookMap["asks"].set(e,[o,o]),this.orderBookMap["bids"].set(r,[a,a])}this.update_Top8()}else"delta"===s.type&&(this.update_Delta_Price("asks",s.asks),this.update_Delta_Price("bids",s.bids),this.update_Top8())},this.ws1.onclose=()=>{console.log("is Closed 1")}},subscribe(t,s){t&&t.send(JSON.stringify(s))},stop(t,s){t&&t.send(JSON.stringify(s))},subscribeAll(){this.ws1.send(JSON.stringify(this.subscriptionOrderBook)),this.ws2.send(JSON.stringify(this.subscriptionPriceUpdate))},stopAll(){this.ws1.send(JSON.stringify(this.unsubscriptionOrderBook)),this.ws2.send(JSON.stringify(this.unsubscriptionPriceUpdate))},startWebSocket2(){console.log(this.ws2),this.ws2.onopen=()=>{},this.ws2.onmessage=t=>{const s=JSON.parse(t.data).data;if(void 0!==s){const t=this.currentBuyPrice,i=s[0].price;this.currentBuyPrice=i,i>=t?(this.buyPrice_Animation_Active.buy=!0,this.buyPrice_Animation_Active.sell=!1):(this.buyPrice_Animation_Active.buy=!1,this.buyPrice_Animation_Active.sell=!0)}},this.ws2.onclose=()=>{console.log("is Closed 2")}}},created(){this.startWebSocket1(),this.startWebSocket2()},watch:{}},l=c,u=i(1001),_=(0,u.Z)(l,a,n,!1,null,null,null),d=_.exports,p={name:"App",components:{OrderBook:d},data(){return{}},methods:{},created(){}},b=p,h=(0,u.Z)(b,o,r,!1,null,null,null),m=h.exports,v=i(7139);e.ZP.use(v.ZP);var f=new v.ZP.Store({state:{},mutations:{},actions:{},getters:{}});e.ZP.config.productionTip=!1,new e.ZP({store:f,render:t=>t(m)}).$mount("#app")}},s={};function i(e){var o=s[e];if(void 0!==o)return o.exports;var r=s[e]={exports:{}};return t[e].call(r.exports,r,r.exports,i),r.exports}i.m=t,function(){var t=[];i.O=function(s,e,o,r){if(!e){var a=1/0;for(u=0;u<t.length;u++){e=t[u][0],o=t[u][1],r=t[u][2];for(var n=!0,c=0;c<e.length;c++)(!1&r||a>=r)&&Object.keys(i.O).every((function(t){return i.O[t](e[c])}))?e.splice(c--,1):(n=!1,r<a&&(a=r));if(n){t.splice(u--,1);var l=o();void 0!==l&&(s=l)}}return s}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[e,o,r]}}(),function(){i.n=function(t){var s=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(s,{a:s}),s}}(),function(){i.d=function(t,s){for(var e in s)i.o(s,e)&&!i.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:s[e]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)}}(),function(){var t={143:0};i.O.j=function(s){return 0===t[s]};var s=function(s,e){var o,r,a=e[0],n=e[1],c=e[2],l=0;if(a.some((function(s){return 0!==t[s]}))){for(o in n)i.o(n,o)&&(i.m[o]=n[o]);if(c)var u=c(i)}for(s&&s(e);l<a.length;l++)r=a[l],i.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return i.O(u)},e=self["webpackChunkorderbook"]=self["webpackChunkorderbook"]||[];e.forEach(s.bind(null,0)),e.push=s.bind(null,e.push.bind(e))}();var e=i.O(void 0,[998],(function(){return i(38)}));e=i.O(e)})();
//# sourceMappingURL=app.b66f4000.js.map